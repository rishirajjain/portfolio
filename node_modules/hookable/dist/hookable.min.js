!function(o,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(o="undefined"!=typeof globalThis?globalThis:o||self).hookable=e()}(this,(function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(e)}function e(o,e,t,n,r,i,s){try{var u=o[i](s),a=u.value}catch(o){return void t(o)}u.done?e(a):Promise.resolve(a).then(n,r)}function t(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}function n(o,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(o,n.key,n)}}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;for(var i in e){var s=e[i],u=n?"".concat(n,":").concat(i):i;"object"===o(s)&&null!==s?r(s,t,u):t[u]=s}return t}function i(o,e){return o.reduce((function(o,t){return o.then((function(){return e(t)}))}),Promise.resolve(null))}return function(){function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:console;t(this,o),this._logger=e,this._hooks={},this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this)}var s,u,a,c,l;return s=o,(u=[{key:"hook",value:function(o,e){var t=this;if(!o||"function"!=typeof e)return function(){};for(var n,r=o;this._deprecatedHooks[o];)"string"==typeof(n=this._deprecatedHooks[o])&&(n={to:n}),o=n.to;return n&&this._logger&&(n.message?this._logger.warn(n.message):this._logger.warn("".concat(r," hook has been deprecated")+(n.to?", please use ".concat(n.to):""))),this._hooks[o]=this._hooks[o]||[],this._hooks[o].push(e),function(){e&&(t.removeHook(o,e),e=null)}}},{key:"removeHook",value:function(o,e){if(this._hooks[o]){var t=this._hooks[o].indexOf(e);-1!==t&&this._hooks[o].splice(t,1),0===this._hooks[o].length&&delete this._hooks[o]}}},{key:"deprecateHook",value:function(o,e){this._deprecatedHooks[o]=e}},{key:"deprecateHooks",value:function(o){Object.assign(this._deprecatedHooks,o)}},{key:"addHooks",value:function(o){var e=this,t=r(o),n=Object.keys(t).map((function(o){return e.hook(o,t[o])}));return function(){n.splice(0,n.length).forEach((function(o){return o()}))}}},{key:"removeHooks",value:function(o){var e=r(o);for(var t in e)this.removeHook(t,e[t])}},{key:"callHook",value:(c=function*(o){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];if(this._hooks[o])try{yield i(this._hooks[o],(function(o){return o.apply(void 0,t)}))}catch(e){"error"!==o&&(yield this.callHook("error",e)),this._logger&&(this._logger.fatal?this._logger.fatal(e):this._logger.error(e))}},l=function(){var o=this,t=arguments;return new Promise((function(n,r){var i=c.apply(o,t);function s(o){e(i,n,r,s,u,"next",o)}function u(o){e(i,n,r,s,u,"throw",o)}s(void 0)}))},function(o){return l.apply(this,arguments)})}])&&n(s.prototype,u),a&&n(s,a),o}()}));
